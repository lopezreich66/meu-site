<section id="promo"><!-- Promoções Imperdíveis -->
    <div class="promo-card">
        <img src="caixas-sibutramina.jpg" alt="Caixas Sibutramina">
        <h2>R$90</h2>
        <button class="pay-btn" data-amount="90">Pagar</button>
    </div>
    <div class="promo-card">
        <img src="caixas-sibutramina.jpg" alt="Caixas Sibutramina">
        <h2>R$150</h2>
        <button class="pay-btn" data-amount="150">Pagar</button>
    </div>
    <div class="promo-card">
        <img src="caixas-sibutramina.jpg" alt="Caixas Sibutramina">
        <h2>R$220</h2>
        <button class="pay-btn" data-amount="220">Pagar</button>
    </div>
</section>

<script>
    const payButtons = document.querySelectorAll('.pay-btn');
    payButtons.forEach(button => {
        button.addEventListener('click', async () => {
            const amount = button.getAttribute('data-amount');
            const response = await fetch('/.netlify/functions/create-payment', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ amount, orderId: 'SOME_ORDER_ID', title: 'Purchase' })
            });

            if (response.ok) {
                const data = await response.json();
                window.location.href = data.checkoutUrl;
            } else {
                const errorData = await response.json();
                if (errorData.code === 'AMOUNT_TOO_LARGE') {
                    const email = prompt('O valor excede o limite de R$150. Por favor, insira seu e-mail:');
                    if (email) {
                        window.location.href = 'mailto:' + email + '?subject=Pedido&body=Limite de R$220 ultrapassado. Por favor, entre em contato.';
                    }
                }
            }
        });
    });
</script>